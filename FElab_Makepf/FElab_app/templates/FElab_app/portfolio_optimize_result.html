{% extends 'FElab_app/base.html' %}

{% block content %}
{% load static %}
<input type="hidden" value= '{{ data }}' id='any'/>
<head>
    <script type='text/javascript' src="{% static 'js/portfolio_optimize_result.js' %}"></script>
</head>
<div style="display:flex;justify-content:center; padding:20px;background-color: white;border-bottom: 1px solid #eeeeee;margin:0 40px;">
    <div class="commentBox" style="width:90%;position:relative;">
        <span style='font-size: 35px;color:#06c;'>포트폴리오 이론</span>은 해리 마코위츠(Harry Max Markowitz)에 의해 체계화된 이론으로, 자산을 분산투자하여 포트폴리오를 만들게 되면 분산투자 전보다 위험을 감소시킬 수 있다는 이론입니다.
        투자자산의 가치는 그 투자로부터 기대되는 수익률이 클수록 커지며, 반면에 위험이 클수록 작아집니다. 지배 원리란 같은 위험 하에서는 기대 수익률이 높은 것이, 같은 기대수익률 하에서는 위험이 작은 것이 그렇지 않은 투자대상을 지배한다는 것입니다. 이 지배원리에 입각하여 선택되는 투자안이 <span style='font-size: 35px;color:#06c;'>효율적 투자대상</span>이 됩니다.
    </div>
</div>
<section class='content'>
    <div class='wrap'>
        <section class='portfolio_optimize'>
            <article class='main' style='overflow:hidden;'>
                <h2 class="topicTitle" style='text-align: center;'>내 포트폴리오</h2><br>
            </article>
            <div class="opt_report" style="margin-bottom: 20px">
                <canvas id="opt_report_chart" height="100vh" width="300"></canvas>
            </div>
            <div style='display:flex;justify-content: center;'>
                <h2 class="topicTitle" style="font-size: 20px;">평균 수익률</h2>
                <span id="user_ret"></span>
                <h2 class="topicTitle" style="font-size: 20px;">표준 편차 </h2>
                <span id="user_vol"></span>
            </div>
            <div  style='height:200px; overflow-y: auto;overflow-x: hidden;'>
                <table class='table optimize_table'>
                    <thead>
                        <tr>
                            <th style="text-align: center;">자산 배분</th>
                            <th class='numberCell'>Allocation</th>
                        </tr>
                    </thead>
                    <tbody id='opt_report_table'>
                    </tbody>
                </table>
            </div>
        </section>
    </div>
</section>
<section class='content'>
    <div class='wrap'>
        <section class='portfolio_optimize'  style='margin-bottom:40px;'>
            <article class='main' style='overflow:hidden;text-align: center;'>
                <h2 class="topicTitle">효율적 투자선</h2><br>
                <span style='font-size: 15px;font-family: AppleSDGothicNeoM;'>효율적인 투자자는 같은 수익을 내는 자산이 있다면 더 낮은 위험도를 선호할 것이고, 같은 위험도를 가진 자신이 있다면 수익률이 더 높은 자산을 선호할 것입니다. 내가 가진 자산들을 어떻게 배분하느냐에 따라 수익률도 달라지고 위험도(분산)도 달라지는데 이 때 가장 효율적으로 배분하는 포트폴리오 점들을 따라 그린 선이 효율적 투자선입니다.</span>
            </article>
        </section>
    </div>
</section>
<div class="optimize_result" id='optimize_result' style='margin-top:0;'>
    <div class='left_block' style="width:70%;margin: 0 0 0 100px;">
        <div class="contentsBox" style="height: 500px;cursor:default;">
        <canvas id='efficient_frontier_graph' style="width: 100%;height: 100%;"></canvas>
        </div>
        <div>
            <h2 style='font-size: 18px;color:#cccccc;'>좌표 위에 커서를 올리시면 배분 비중과 수익률, 표준편차를 확인할 수 있습니다. 표준편차는 변동하는 정도(리스크)를 나타냅니다.</h2>
        </div>
    </div>
    <div class='right_block' style='width:40%;margin: 0 100px 0 0;'>
        <div>
            <div class='graph_title' style='padding-top: 200px'>
                <h2 id='strategy_name_h2' style='margin-top:0'></h2>
            </div>
            <div class='graph_comment'>
                <span id='strategy_comment_span' style='font-size: 15px;'></span>
            </div>
        </div>
        <div style='display: flex;justify-content: center;'>
            <button id='add_asset_btn'  style="padding:20px;margin:20px;width:120px;">자산 추가하기</button>
            <button onclick="tobacktest()" id="tobacktest_btn" style="padding:20px;margin:20px;">백테스트 하기</button>
        </div>
    </div>
</div>

<div id='add_block' style='margin:150px 0 50px;'>
    <section class='content'>
        <div class='wrap'>
            <section class='portfolio_optimize'  style='margin-bottom:40px;'>
                <article class='main' style='overflow:hidden;text-align: center;'>
                    <h2 class="topicTitle">자산 추가하기</h2><br>
                    <span style='font-size: 15px;font-family: AppleSDGothicNeoM;'>내가 구성한 포트폴리오에 새로운 자산을 추가했을때 효율적 투자선이 어떻게 변하는지 확인할 수 있고 어떤 종목을 추가해야할지 모를때는 추천을 받으실 수도 있습니다.</span>
                </article>
            </section>
        </div>
    </section>
    <div style='display:flex;justify-content: center;'>
        <div class='left_block' style="width:40%;margin: 0 0 0 100px;">
            <div style='margin: 20px 0;display:flex;justify-content: center;'>
                <div class="searchBox">
                    <input id="comboBox" onfocus="if(this.value == '종목 검색') { this.value = ''; }" value="종목 검색" />
                    <input type='button' id="putin_btn" style="width:80px;background-color:#FA8800;height:40px;border:none;color:white;" value='담기'></button>
                </div>
            </div>
            <div class='added_assetsBox' style='margin: 20px;height:270px; overflow-y: auto;overflow-x: hidden;'>
                <table class='table backtest_table'>
                    <thead>
                        <tr>
                            <th class='numberCell'>자산</th>
                            <th class='numberCell'>비중</th>
                            <th class='numberCell'></th>
                            <th class='numberCell'></th>
                        </tr>
                    </thead>
                    <tbody id='adjusted_asset_row'>
                    </tbody>
                </table>
            </div>
            <div style='display:flex;justify-content: center;'>
                <button id='change_btn' style="width:40%;background-color:#00469d;height:50px;border:none;color:white;">반영하기</button>
            </div>
        </div>
        <div class='right_block' style='width:70%;margin: 0 100px 0 0;'>
            <div class="contentsBox" style="height: 400px;cursor:default;margin-top:20px">
                <canvas id='after_efficient_frontier_graph' style="width: 100%;height: 100%;"></canvas>
             </div>
        </div>
    </div>
</div>
<footer>
</footer>
<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.4/css/bootstrap.min.css">
<div class="popup" data-popup="showSise"> <!-- 표출되는 팝업 입니다. --> 
    <div class="popup-inner"> 
        <div class="contentsBox" style="height: 500px;cursor:default;border:none;">
            <div id="controls" style="width: 100%; overflow: hidden;">
                <div style="float: left; margin-left: 15px;">
                    From: <input type="text" id="fromfield" class="amcharts-input" />
                    To: <input type="text" id="tofield" class="amcharts-input" />
                </div>
                <div style="float: right; margin-right: 15px;">
                    <button id="b1m" class="amcharts-input">1m</button>
                    <button id="b3m" class="amcharts-input">3m</button>
                    <button id="b6m" class="amcharts-input">6m</button>
                    <button id="b1y" class="amcharts-input">1y</button>
                    <button id="bytd" class="amcharts-input">YTD</button>
                    <button id="bmax" class="amcharts-input">MAX</button>
                </div>
            </div>
            <div id="chartdiv"></div>
        </div>
        <div class="popup-contents"> 
            <a class="popup-close" data-popup-close="showSise" href="#">X</a> <!-- 팝업 닫기 버튼입니다 -->
        </div>
    </div> 
</div>
{% endblock %}